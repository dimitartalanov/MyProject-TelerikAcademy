import firebaseDb from"firebaseDb";import validator from"validator";import encryptor from"encryptor";class UserModel{constructor(e){this.database=e}signIn(e,r){return r=encryptor.encrypt(r),firebaseDb.signInWithEmail(e,r,this.database).catch(e=>Promise.reject(e))}signUp(e,r,t,a){try{validator.validateSignUpForm(e,r,t)}catch(e){return Promise.reject({code:"500",message:e})}return r=encryptor.encrypt(r),firebaseDb.createUserWithEmail(e,r,t,this.database).then(()=>{const e=firebase.auth().currentUser,r=a;e.updateProfile({displayName:t,photoURL:r})}).catch(e=>Promise.reject(e))}signOut(){return firebaseDb.signOut(this.database).catch(e=>Promise.reject(e))}}export default UserModel;